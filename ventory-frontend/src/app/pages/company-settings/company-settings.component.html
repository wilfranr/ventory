<p-toast></p-toast>
<div class="card max-w-2xl mx-auto">
    <h2 class="text-center text-xl font-bold mb-4">Datos generales de la empresa</h2>
    <form [formGroup]="form" class="grid formgrid gap-4 p-fluid" (ngSubmit)="save()">
        <div class="field col-12 md:col-6">
            <label for="name" class="font-semibold">Nombre</label>
            <input id="name" type="text" pInputText formControlName="name" class="w-full" [readonly]="readonlyMode" />
            @if (form.get('name')?.invalid && form.get('name')?.touched) {
                <small class="text-red-400">Requerido</small>
            }
        </div>
        <div class="field col-12 md:col-6">
            <label for="nit" class="font-semibold">NIT</label>
            <input id="nit" type="text" pInputText formControlName="nit" class="w-full" [readonly]="readonlyMode" />
            @if (form.get('nit')?.invalid && form.get('nit')?.touched) {
                <small class="text-red-400">Requerido</small>
            }
        </div>
        <div class="field col-12 md:col-6">
            <label for="email" class="font-semibold">Email</label>
            <input id="email" type="email" pInputText formControlName="email" class="w-full" [readonly]="readonlyMode" />
            @if (form.get('email')?.invalid && form.get('email')?.touched) {
                <small class="text-red-400">Email inválido</small>
            }
        </div>
        <div class="field col-12 md:col-6">
            <label for="address" class="font-semibold">Dirección</label>
            <input id="address" type="text" pInputText formControlName="address" class="w-full" [readonly]="readonlyMode" />
        </div>
        <div class="field col-12 md:col-6">
            <label for="phones" class="font-semibold">Teléfonos</label>
            <input id="phones" type="text" pInputText formControlName="phones" class="w-full" [readonly]="readonlyMode" />
        </div>
        <div class="field col-12 md:col-6">
            <label for="website" class="font-semibold">Sitio web</label>
            <input id="website" type="text" pInputText formControlName="website" class="w-full" [readonly]="readonlyMode" />
        </div>
        <div class="field col-12 md:col-6">
            <label for="currency" class="font-semibold">Moneda</label>
            <p-dropdown id="currency" [options]="currencies" formControlName="currency" optionLabel="label" optionValue="value" class="w-full" [disabled]="readonlyMode"></p-dropdown>
            @if (form.get('currency')?.invalid && form.get('currency')?.touched) {
                <small class="text-red-400">Requerido</small>
            }
        </div>
        <div class="field col-12 md:col-6">
            <label for="vat" class="font-semibold">IVA (%)</label>
            <p-inputNumber id="vat" formControlName="vatPercent" inputId="vat" [min]="0" [max]="100" [useGrouping]="false" class="w-full" [disabled]="readonlyMode"></p-inputNumber>
            @if (form.get('vatPercent')?.invalid && form.get('vatPercent')?.touched) {
                <small class="text-red-400">Valor entre 0 y 100</small>
            }
        </div>
        <div class="field col-12">
            <label for="logo" class="font-semibold">Logo</label>
            <p-fileupload
                (onSelect)="onLogoSelect($event)"
                (onClear)="onLogoClear()"
                [multiple]="false"
                accept="image/*"
                maxFileSize="10000000"
                mode="advanced"
                [showUploadButton]="false"
                chooseLabel="Elegir logo"
                cancelLabel="Cancelar"
            >
                <ng-template pTemplate="content">
                    <div *ngIf="logoPreview" class="p-fileupload-previews">
                      <div class="p-fileupload-preview">
                        <img [src]="logoPreview" alt="Logo Preview" class="max-h-32 mt-2" />
                      </div>
                    </div>
                    <div *ngIf="!logoPreview" class="p-fileupload-empty">
                        <p>Arrastra y suelta la imagen aquí.</p>
                    </div>
                </ng-template>
            </p-fileupload>
        </div>
        @if (!readonlyMode) {
            <div class="col-12 flex justify-end">
                <p-button type="submit" label="Guardar" [disabled]="form.invalid"></p-button>
            </div>
        }
    </form>
</div>
